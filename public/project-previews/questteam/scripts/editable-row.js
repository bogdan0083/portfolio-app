!function(t,e){"use strict";var n=function(e,n){var i=this;i.DEFAULTS={toggable:!0,container:"tr",inputWrapperClass:".js-field-wrap",isOpen:!1,triggerToggleClass:"js-trigger-active",textOpen:"сохранить",textClosed:"изменить"},i.options=t.extend({},i.DEFAULTS,n),i.$triggerEl=e,i.rowsData={},i.$containerElem=i.$triggerEl.closest(i.options.container),i.currentActiveContainer,i.isOpen=i.options.isOpen===!0,i.activeId,i.init()};n.prototype.init=function(){var e=this;e.buildInitData(),e.$triggerEl.on("click",function(n){var i=t(this);t.proxy(e.onTriggerClick(n,i),e)})},n.prototype.onTriggerClick=function(t,e){t.preventDefault();var n=this;n.activeId=e.data("edit-id");var i=e.closest(n.options.container),r=i.find(":input"),a=i.find(n.options.inputWrapperClass),o=i.find("[data-for-name]");n.buildDataObject(e,r),n.toggleView(a,o,r,e)},n.prototype.buildDataObject=function(e,n){var i=this,r=i.activeId;if(i.rowsData[r].isOpen){var a=/\r?\n/g,o=n.map(function(e,n){var i=jQuery(this).val(),r=n.type;if("button"===r||"submit"===r)return null;if(jQuery.isArray(i))return jQuery.map(i,function(t){return{name:n.name,value:t.replace(a,"\r\n")}});var o=t(n).text();if("file"===r)return console.log(n.files),{name:n.name,value:i.replace(a,"\r\n"),files:n.files};if(o)return{name:n.name,value:i.replace(a,"\r\n"),text:n.selectedOptions[0].innerText};if("radio"===r||"checkbox"===r){if(!n.checked)return;return{name:n.name,value:i.replace(a,"\r\n"),text:n.parentNode.innerText}}return{name:n.name,value:i.replace(a,"\r\n"),text:i.replace(a,"\r\n")}}).get();i.rowsData[r].rowArray=o,i.options.onClose&&i.options.onClose(i.rowsData[r].rowArray,r)}},n.prototype.buildInitData=function(){var e=this;e.$triggerEl.each(function(){var n=t(this).data("edit-id");e.rowsData[n]={isOpen:e.options.isOpen}})},n.prototype.toggleView=function(e,n,i,r){var a=this,o=a.activeId;if(e.toggleClass("js-hidden"),n.toggleClass("js-hidden"),r.toggleClass(a.options.triggerToggleClass),a.toggleTriggerText(r),a.rowsData[o].isOpen){var s=a.rowsData[o].rowArray;n.each(function(e,n){t(n).text(s[e].text)})}a.rowsData[o].isOpen=!a.rowsData[o].isOpen},n.prototype.toggleTriggerText=function(t){var e=this,n=e.activeId;e.rowsData[n].isOpen?t.children().length>0?t.find("span").text(e.options.textClosed):t.text(e.options.textClosed):t.children().length>0?t.find("span").text(e.options.textOpen):t.text(e.options.textOpen)},t.fn.editableRow=function(){var e=t(this),i=arguments[0],r=this;return i?r.editableRow=new n(e,i):r.editableRow=new n(e),r}}(jQuery,window);